<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">

    <!-- Override CartPage to remove tax display -->
    <t t-inherit="pos_self_order.CartPage" t-inherit-mode="extension">
        <!-- Remove the tax line by replacing it with empty content -->
        <xpath expr="//p[contains(@class, 'text-muted')]" position="replace">
        </xpath>

        <!-- Add edit button for each line item in meal mode (餐點結) -->
        <xpath expr="//div[hasclass('product-controllers')]//div[hasclass('line-price')]" position="after">
            <button t-if="selfOrder.config.self_ordering_pay_after === 'meal' and Object.keys(selfOrder.currentOrder.changes).length === 0"
                    class="btn btn-sm btn-outline-primary ms-2"
                    t-on-click="() => this.clickOnLine(line)"
                    title="編輯">
                <i class="fa fa-pencil"></i>
            </button>
        </xpath>
    </t>

    <!-- Override OrderWidget to hide "本次加點" in meal mode -->
    <t t-inherit="pos_self_order.OrderWidget" t-inherit-mode="extension">
        <!-- Hide the "to-order" section (本次加點) when in meal mode -->
        <xpath expr="//div[contains(@class, 'to-order')]" position="attributes">
            <attribute name="t-if">selfOrder.config.self_ordering_pay_after !== 'meal'</attribute>
        </xpath>
    </t>

</templates>
